#!/usr/bin/env ruby
# frozen_string_literal: true

# Allow `require` calls relative to `lib`
$LOAD_PATH.unshift File.expand_path(File.join(File.dirname(__FILE__), '..', 'lib'))

require 'secret_santa/csv_parser'
require 'secret_santa/participant'
require 'secret_santa/randomizer'
require 'secret_santa/reporter'

redact_recipients = false

csv_path = ARGV.first
participants = SecretSanta::CsvParser.new(csv_path: csv_path).parse
reporter = SecretSanta::Reporter.new(redact_recipients: redact_recipients)

puts 'Generating assignments for the following groups and solo participants'
puts
reporter.report_participants(participants: participants)

randomizer = SecretSanta::Randomizer.new(participants: participants)
assignments = randomizer.randomize

reporter.report_assignments(assignments: assignments)

# vim: set ft=ruby
